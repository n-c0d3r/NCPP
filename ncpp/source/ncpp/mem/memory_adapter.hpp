#pragma once

/** @file ncpp/mem/memory_adapter.hpp
*	@brief Implements memory adaptor base class template.
*/



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



#pragma region Includes

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include <ncpp/prerequisites.hpp>
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include <ncpp/mem/allocator.hpp>
#include <ncpp/mem/crt_allocator.hpp>
#include <ncpp/mem/memory_provider.hpp>

#pragma endregion



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



namespace ncpp {

    namespace mem {

        template<
            class F_memory_adapter__,
            class F_memory_provider__,
            class F_source_in__
        >
        class TA_memory_adapter {

        private:
            using F_this = TA_memory_adapter<
                F_memory_adapter__,
                F_memory_provider__,
                F_source_in__
            >;

        public:
            using F_memory_adapter = F_memory_adapter__;
            using F_memory_provider = F_memory_provider__;
            using F_source_in = F_source_in__;

        public:
            using F_memory_block = typename TF_memory_provider_safe_infos<F_memory_provider>::F_memory_block;
            using F_memory_provider_desc = typename TF_memory_provider_safe_infos<F_memory_provider>::F_memory_provider_desc;
            using F_memory_provider_management_params = typename TF_memory_provider_safe_infos<F_memory_provider>::F_memory_provider_management_params;

            using F_child_memory_block = typename TF_memory_provider_safe_infos<F_memory_provider>::F_child_memory_block;



        private:
            F_source_in* source_in_p_;

        public:
            NCPP_FORCE_INLINE F_source_in* source_in_p() noexcept { return source_in_p_; }
            NCPP_FORCE_INLINE const F_source_in* source_in_p() const noexcept { return source_in_p_; }



        protected:
            NCPP_FORCE_INLINE TA_memory_adapter(F_source_in* source_in_p) :
                source_in_p_(source_in_p)
            {
            }

            NCPP_FORCE_INLINE TA_memory_adapter(const TA_memory_adapter& x) = delete;
            NCPP_FORCE_INLINE TA_memory_adapter(TA_memory_adapter&& x) = delete;

            NCPP_FORCE_INLINE TA_memory_adapter& operator=(const TA_memory_adapter& x) = delete;
            NCPP_FORCE_INLINE TA_memory_adapter& operator=(TA_memory_adapter&& x) = delete;



        public:
            NCPP_FORCE_INLINE b8 operator==(const TA_memory_adapter& x) const noexcept {

                return (this == &x);
            }



        public:
            F_memory_block* pop_block();
            void push_block(F_memory_block*);

        };

    }

}

